#:import MDRoundFlatButton kivymd.button.MDRoundFlatButton
#:import MDTextFieldRect kivymd.textfields.MDTextFieldRect
#:import MDTextField kivymd.textfields.MDTextField
#:import MDTextFieldClear kivymd.textfields.MDTextFieldClear
#:import MDRaisedButton kivymd.button.MDRaisedButton
#:import MDTextFieldRect kivymd.textfields.MDTextFieldRect
#:import MDTextFieldRound kivymd.textfields.MDTextFieldRound
#:import MDSwitch kivymd.selectioncontrols.MDSwitch
#:import GalleryButton presenter.gallery_button




<DeliveryRequestForm>:
    orientation: "vertical"
    padding: (0, 0, 0, 20)
    spacing: 10
    photo_path: None

    ScrollView:
        canvas.before:
            Color:
                rgba: 222/255, 222/255, 222/255, 1
            Line:
                width: 0.5
                rectangle: self.x, self.y, self.width, 0

        BoxLayout:
            size_hint_y:None
            height: grid.minimum_height + form_title.height + 10
            orientation: 'vertical'

            MDLabel:
                id: form_title
                font_style: 'H6'
                halign: 'center'
                valign: 'bottom'
                text_size: self.width, None
                size_hint: 1, None
                text: "Request a Delivery"

            GridLayout:
                id: grid
                cols: 3

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Package: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                BoxLayout:
                    size_hint_y: None
                    height: dp(80)
                    MDTextField:
                        id: package_name
                        required: True
                        helper_text_mode: 'on_error'
                        write_tab: False
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                Widget:
                    size_hint: None, None
                    width: dp(60)
                    height: dp(80)

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "From: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                BoxLayout:
                    size_hint_y: None
                    height: dp(80)
                    MDTextField:
                        id: from_text
                        required: True
                        helper_text_mode: 'on_error'
                        write_tab: False
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                        on_text: root._on_search_from()
                HollowIcon:
                    size_hint_y: None
                    padding: [0, dp(20), 0, 0]
                    icon: 'map-marker'
                    theme_text_color: 'Custom'
                    text_color: 212/255, 144/255, 0/255, 1
                    height: dp(80)

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "To: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                BoxLayout:
                    size_hint_y: None
                    height: dp(80)
                    MDTextField:
                        id: dest_text
                        required: True
                        helper_text_mode: 'on_error'
                        write_tab: False
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                        on_text: root._on_search_to()
                HollowIcon:
                    size_hint_y: None
                    padding: [0, dp(20), 0, 0]
                    icon: 'map-marker'
                    theme_text_color: 'Custom'
                    text_color: 152/255, 224/255, 232/255, 1
                    height: dp(80)

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(100)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Weight: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}

                BoxLayout:
                    size_hint: 1, None
                    padding: (10, 0)
                    spacing: 10
                    height: dp(100)

                    MDIconButton:
                        id: weight_walk_button
                        icon: 'walk'
                        theme_text_color: 'Custom'
                        text_color: 128/255, 128/255, 128/255, 1


                    MDIconButton:
                        id: weight_car_button
                        icon: 'car'
                        theme_text_color: 'Custom'
                        text_color: 128/255, 128/255, 128/255, 1


                    MDIconButton:
                        id: weight_truck_button
                        icon: 'truck'
                        theme_text_color: 'Custom'
                        text_color: 128/255, 128/255, 128/255, 1


                HollowIcon:
                    size_hint_y: None
                    padding: [0, dp(30), 0, 0]
                    icon: 'dumbbell'
                    theme_text_color: 'Custom'
                    text_color: 0/255, 0/255, 0/255, 1
                    height: dp(100)

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Payment: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                BoxLayout:
                    size_hint_y: None
                    height: dp(80)
                    MDTextField:
                        id: payment_amount
                        required: True
                        helper_text_mode: 'on_error'
                        input_filter: 'int'
                        write_tab: False
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                MDIconButton:
                    size_hint_y: None
                    padding: [0, 30, 0, 0]
                    theme_text_color: 'Custom'
                    text_color: 255/255, 255/255, 255/255, 1
                    height: dp(80)
                    HollowIcon:
                        icon: 'currency-usd'
                        theme_text_color: 'Custom'
                        text_color: 212/255, 144/255, 0/255, 1

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Money lock: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                BoxLayout:
                    size_hint_y: None
                    height: dp(80)
                    MDTextField:
                        id: money_lock_amount
                        input_filter: 'int'
                        required: True
                        helper_text: "The deposit you require until the package is delivered"
                        helper_text_mode: 'persistent'
                        write_tab: False
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}
                MDIconButton:
                    size_hint_y: None
                    padding: [0, 30, 0, 0]
                    theme_text_color: 'Custom'
                    text_color: 255/255, 255/255, 255/255, 1
                    height: dp(80)

                    HollowIcon:
                        icon: 'currency-usd'
                        theme_text_color: 'Custom'
                        text_color: 212/255, 144/255, 0/255, 1

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(80)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Fragile? "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.3}

                BoxLayout:
                    size_hint: 1, None
                    padding: [dp(20), dp(30), 0, 0]
                    height: dp(80)

                    MDSwitch:
                        id: fragile_bool
                        size_hint: (None, None)
                        width: 40
                        height: 40


                Widget:
                    size_hint: None, None
                    width: 60
                    height: dp(80)

                RelativeLayout:
                    size_hint: (None, None)
                    width: dp(100)
                    height: dp(180)
                    MDLabel:
                        halign: "right"
                        theme_text_color: 'Primary'
                        text: "Photo: "
                        pos_hint: {'center_x': 0.5, 'center_y': 0.15}

                AsyncImage:
                    height: dp(150)
                    size_hint_y: None
                    id: photo_preview
                    source: root.photo_path

                GalleryButton:

                    size_hint_y: None
                    id: 'gallery_button'
                    icon: 'camera'
                    path_selected_callback: root._set_photo_path
                    text_color: app.theme_cls.primary_color
                    opposite_colors: True
                    elevation_normal: 8
                    md_bg_color: 255/255, 255/255, 255/255, 1
                    pos_hint: {'right':0}

                RelativeLayout:
                    size_hint: None, None
                    width: dp(100)
                    height: dp(120)

                    BoxLayout:
                        size_hint: 1, None
                        height: desc_label.texture_size[1]
                        pos_hint: {'center_x': 0.5, 'center_y': 0.22}

                        MDLabel:
                            id: desc_label
                            halign: "right"
                            theme_text_color: 'Primary'
                            text: "Description: "

                BoxLayout:
                    height: dp(120)
                    size_hint_y: None

                    MDTextField:
                        required: True
                        id: description_text
                        helper_text_mode: 'on_error'
                        hint_text: 'Package Description'
                        max_text_length: 300
                        icon: 'lock-outline'
                        multiline: True
                        foreground_color: 212/255, 144/255, 0/255, 1
                        size_hint_x: 0.8
                        pos_hint: {'center_x': 0.5, 'bottom': 1}

                Widget:
                    size_hint: None, None
                    width: 70
                    height: dp(120)

    MDRaisedButton:
        id: request_button
        disabled: True
        text: "Request Delivery"
        write_tab: False
        pos_hint: {'center_x': 0.5, 'center_y': .15}
        on_press: root._submit_request()
